#!/bin/bash

# Log directory
LOG_DIR="/var/log/apache2"

# List log files using sudo and store in an array
echo "Listing log files in $LOG_DIR:"
mapfile -t files < <(sudo ls "$LOG_DIR")

# Check if there are any log files
if [ ${#files[@]} -eq 0 ]; then
    echo "No log files found in $LOG_DIR."
    exit 1
fi

# Display log files with numbering
for i in "${!files[@]}"; do
    echo "$((i + 1)): ${files[i]}"
done

# Prompt user to choose a file by number
read -p "Choose a log file by number (1-${#files[@]}): " choice

# Validate input
if [[ "$choice" -gt 0 && "$choice" -le "${#files[@]}" ]]; then
    # Get the selected file
    selected_file="${files[$((choice - 1))]}"
    
    # Tail the selected log file with sudo
    echo "Tailing $LOG_DIR/$selected_file..."
    sudo tail -n 22 -f "$LOG_DIR/$selected_file"
else
    echo "Invalid choice. Please run the script again."
fi